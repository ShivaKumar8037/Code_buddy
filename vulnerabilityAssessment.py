import streamlit as st
from palm_api import palmAPI




def performance_optimization_tips(exampleCode, api_key):
    st.write("Performance Optimization Tips: ")
    
    if not exampleCode.strip():
        
        return

    try:
        st.write("Performance optimization suggesstions: ")
        # Fetch performance optimization tips using the palmAPI function
        optimization_tips = palmAPI(api_key, f"Analyze this code for performance bottlenecks and suggest optimizations for speed and resource usage: \n\n{exampleCode}")
        st.markdown(optimization_tips)
    except Exception as e:
        # Handle any exceptions that occur during the API call
        st.error("An error occurred while fetching performance optimization tips.")
        st.error(f"Error details: {e}")






def show(api_key=None):
    st.title("Security Vulnerability Assessment")
    if api_key:
        if 'example_code' in st.session_state:
            # Access the exampleCode
            exampleCode = st.session_state['example_code']
            
            # Display or process the exampleCode
            st.code(exampleCode)
            performance_optimization_tips(exampleCode, api_key)
        else:
            st.write("No example code was provided in code Expaliner Page.")
    else: 
        st.warning("Please enter your API key in the sidebar to access this feature.")